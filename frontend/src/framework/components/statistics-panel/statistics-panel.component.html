<!-- Statistics Panel Component Template -->
<p-panel
  [toggleable]="true"
  [(collapsed)]="panelCollapsed"
  styleClass="mb-3"
  [attr.data-testid]="environment.includeTestIds ? 'statistics-panel' : null">

  <ng-template pTemplate="header">
    <div class="panel-header">
      <i class="pi pi-chart-bar"></i>
      <span class="panel-title">Statistics & Distributions</span>
      <span class="chart-count">({{ visibleCharts.length }} charts)</span>
    </div>
  </ng-template>

  @if (!panelCollapsed) {
    <div class="statistics-content">
      <!-- No data message -->
      @if (!statistics()) {
        <div class="no-data-message">
          <i class="pi pi-info-circle"></i>
          <p>No statistics available. Add filters or select data to view distributions.</p>
        </div>
      }
      <!-- Charts grid -->
      @if (statistics()) {
        <div class="charts-grid">
          @for (item of visibleCharts; track trackByChartId($index, item)) {
            <div
              class="chart-container"
              [attr.data-testid]="environment.includeTestIds ? ('chart-' + item.config.id) : null">
              <div class="chart-title">{{ item.config.title }}</div>
              <app-base-chart
                [dataSource]="item.dataSource"
                [statistics]="statistics()"
                [highlights]="highlights()"
                [selectedValue]="null"
                (chartClick)="onChartClick($event, item.config.id)">
              </app-base-chart>
            </div>
          }
        </div>
      }
    </div>
  }
</p-panel>
